<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div class="container">
    <div class="leftSide">
        <div class="header">

            <ul class="nav_icons">
<!--                <li><ion-icon name="scan-circle-outline"></ion-icon></li>-->
<!--                <li><ion-icon name="chatbox"></ion-icon></li>-->
<!--                <li><ion-icon name="ellipsis-vertical"></ion-icon></li>-->
            </ul>
        </div>
        <div class="chatlist">
            <div class="block unread">
                <div class="details">
                    <div class="message_p">
                        <p>æ­¤å¤„å¢åŠ ä¸€äº›é…ç½®é€‰é¡¹</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="rightSide">
        <div class="header">
            <div class="imgText">

                <h4><br><span></span></h4>
            </div>
            <ul class="nav_icons">
<!--                <li><ion-icon name="search-outline"></ion-icon></li>-->
<!--                <li><ion-icon name="ellipsis-vertical"></ion-icon></li>-->
            </ul>
        </div>

        <div class="chatBox" name="chatBox">
            <div class="message my_message">
                <p>æœ€è¿‘ï¼Œæˆ‘çœ‹äº†ä¸€äº›å¹½é»˜ç¬‘è¯ã€‚<br><span>12:15</span></p>
            </div>
            <div class="message frnd_message">
                <p>å—¯ï¼Œç„¶åå‘¢ï¼Ÿ<br><span>12:16</span></p>
            </div>
            <div class="message my_message">
                <p>ä½ æƒ³å¬å—ï¼Ÿæˆ‘å¯ä»¥ç»™ä½ è®²ä¸€è®²<br><span>12:17</span></p>
            </div>
            <div class="message frnd_message">
                <p>å¥½ç¬‘å—ï¼Ÿ<br><span>12:18</span></p>
            </div>
            <div class="message my_message">
                <p>å¾ˆå¥½ç¬‘çš„ï¼Œä¸€ä¸ªå¥³å­©åœ¨å©šå‰å¦‚ä½•åŒºåˆ†å†…å‘å’Œå¤–å‘çš„è½¯ä»¶å¼€å‘äººå‘˜ï¼Ÿæ€§æ ¼å¤–å‘çš„å¼€å‘äººå‘˜åœ¨ä¸æ‚¨äº¤è°ˆæ—¶ä¼šçœ‹ç€æ‚¨çš„é‹å­ã€‚é‚£ä¹ˆï¼Œå†…å‘çš„äººæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿä»–ä»¬ä¸èƒ½å’Œå¥³äººè¯´è¯ã€‚ğŸ˜„<br><span>12:19</span></p>
            </div>
            <div class="message frnd_message">
                <p>å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ<br><span>12:20</span></p>
            </div>

        </div>
        <div class="chatBox_input">
<!--            <ion-icon name="happy-outline"></ion-icon>-->
<!--            <ion-icon name="attach-outline"></ion-icon>-->
            <input type="text" placeholder="è¾“å…¥èŠå¤©å†…å®¹" id="chatTextInput">
            <ion-icon name="chatbox-ellipses" id="sendMsg"></ion-icon>
        </div>
    </div>
</div>




<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
<script src="https://cdn.staticfile.org/jquery/3.6.4/jquery.min.js"  crossorigin="anonymous"></script>

<script type="text/javascript" charset="UTF-8">
function currentTime(){
 var d = new Date(),str = '';
 str += d.getFullYear()+'-';
 str  += d.getMonth() + 1+'-';
 str  += d.getDate()+' ';
 str += d.getHours()+':';
 str  += d.getMinutes()+':';
 str+= d.getSeconds()+' ';
return str;
}


$(document).ready(function(){
  $("#sendMsg").click(function(){
    var msg = $("input").val();
    if(msg == ""){
      alert("è¾“å…¥ä¸èƒ½ä¸ºç©º");
      return;
    }
    // åˆ›å»ºä¸€ä¸ªæ–°çš„<div>å…ƒç´ 
    var newMessage = $('<div>', { class: 'message my_message' }).html('<p>'+msg+'<br><span>'+currentTime()+'</span></p>');

    // å°†æ–°çš„<div>å…ƒç´ è¿½åŠ åˆ°.chatBoxå®¹å™¨ä¸­
    $('.chatBox').append(newMessage);
	$('#chatTextInput').val("");
    $("#sendMsg").addClass("send_msg");
    $("#sendMsg").text("å‘é€ä¸­...");
	$.ajax({
      url:"/chat/doChat",
      type:"POST",
      dataType: "json",
      headers: {
      "Content-Type": "application/json"
    },
      data:JSON.stringify({
      "message": msg
      }),
      success: function(response) {
        const chatGPTResponse = response.data;
        var respMessage = $('<div>', { class: 'message frnd_message' }).html('<p>'+chatGPTResponse+'<br><span>'+currentTime()+'</span></p>');

        // å°†æ–°çš„<div>å…ƒç´ è¿½åŠ åˆ°.chatBoxå®¹å™¨ä¸­
        $('.chatBox').append(respMessage);

      },
      error: function(error) {

      }
    });
  });
});
</script>
</body>
</html>